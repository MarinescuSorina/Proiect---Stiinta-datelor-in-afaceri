---
title: "Proiect sda"
format: html

editor: visual
mainfont: Times New Roman
sansfont: Times New Roman
---

```{css, echo = FALSE}
.justify {
  text-align: justify !important
}
```

## 1.Descrierea problemei

::: justify
Compania care constituie subiectul de cercetare Ã®n cadrul proiectului se numeÈ™te IBM- International Business Machines (Corporation). VeteranÄƒ Ã®n domeniul tehnologiei, aceasta È™i-a pus amprenta Ã®n istoria marilor corporaÈ›ii prin invenÈ›ii fÄƒrÄƒ de care cele mai uzuale activitÄƒti omeneÈ™ti nu ar mai fi posibile. Ãn prezent problema principalÄƒ cu care se confruntÄƒ este reprezentatÄƒ de creÈ™terea epuizÄƒrii angajaÈ›ilor din cauza volumului mare de muncÄƒ.

Cu ajutorul acestui set de date, care reflectÄƒ performanÈ›a angajaÈ›ilor IBM, ne propunem sÄƒ realizÄƒm o previziune a numÄƒrului de angajaÈ›i care vor deveni epuizaÈ›i. Pentru aceasta, vom aplica regresia logisticÄƒ binomialÄƒ Ã®n funcÈ›ie de venitul lunar È™i vechime; È™i KNN asociat problemei de clasificare. 

## 2.ImportanÈ›a problemei

### De ce e importantÄƒ problema pentru firmÄƒ?

Productivitatea angajaÈ›ilor se reflectÄƒ Ã®n mod direct Ã®n performanÈ›a companiei. Un angajat suprasolicitat nu Ã®È™i Ã®ndeplineÈ™te sarcinile Ã®n mod corespunzÄƒtor ceea ce va afecta rezultatele companiei Ã®ntr-un mod negativ. Astfel, IBM nu se va ridica la aÈ™teptÄƒrile clienÈ›ilor, crescÃ¢nd riscul de a-È™i pierde clientela.

### De ce e importantÄƒ problema pentru noi?

Din perspectiva viitorilor angajaÈ›i existÄƒ reÈ›inerea de a intra Ã®ntr-un mediu toxic de supraexploatare a personalului.

Ãn concluzie, problema identificatÄƒ afecteazÄƒ performanÈ›a firmei atÃ¢t Ã®n plan intern cÃ¢t È™i extern.

## 3.Ce mÄƒsuri s-au luat pentru combaterea problemei?

### MÄƒsuri la nivel global

Ãn cadrul tuturor companiilor existÄƒ riscul de suprasolicitare a angajaÈ›ilor, motiv pentru care au trebuit sÄƒ adopte diverse mÄƒsuri precum: comunicarea constantÄƒ Ã®ntre angajaÈ›i È™i conducere, suport, beneficii salariale, oferirea de tool-uri pentru eficientizarea sarcinilor de muncÄƒ.

### MÄƒsuri luate de IBM

Pentru a reduce riscul epuizÄƒrii angajaÈ›ilor IBM a luat urmÄƒtoarele mÄƒsuri: training, program flexibil de lucru, posibilitatea de a lucra online, beneficii egale pentru toÈ›i angajaÈ›ii indiferent de rasÄƒ/ etnie.

### Studii relevante cu privire la analizarea gradului de epuizare al angajaÈ›ilor IBM

Ãn studiul realizat de Shenghuan Yang de la Jiangxi University of Finance and Economics È™i Md Tariqul Islam de la Syracuse University s-au cÄƒutat principalele motive pentru care angajaÈ›ii aleg sÄƒ demisioneze din IBM. Metodele utilizate de aceÈ™tia s-au concentrat pe exploatarea arborilor de decizie, gÄƒsind venitul lunar, vÃ¢rsta È™i numÄƒrul de companii la care au lucrat ca avÃ¢nd un impact semnificativ asupra angajaÈ›ilor. Ãn continuare au clasificat persoanele Ã®n douÄƒ grupuri prin utilizarea k-means clustering. Ãn cele din urmÄƒ au efectuat o analizÄƒ cantitativÄƒ È™i anume o regresie logisticÄƒ binarÄƒ din care a rezultat cÄƒ uzura persoanelor care au cÄƒlÄƒtorit frecvent a fost de 2,4 ori mai mare decÃ¢t cea a persoanelor care cÄƒlÄƒtoreau rar. De asemenea, au constatat faptul cÄƒ angajaÈ›ii care lucreazÄƒ Ã®n domeniul resurselor umane au o tendinÈ›Äƒ mai mare de a pleca.
:::


## 4. SoluÈ›ie + rezultate 

::: justify
Respectivul set de date a fost preluat de pe data.world È™i conÈ›ine 14 atribute È™i 1470 de entitÄƒÈ›i/indivizi. VÃ¢rsta, frecvenÈ›a cÄƒlÄƒtoriilor Ã®n interes de serviciu È™i sexul sunt atribute categoriale formate din 2 sau 3 clase, iar restul de coloane conÈ›ine date cantitative. Scopul cercetÄƒrii Ã®n aceastÄƒ zonÄƒ este acela de a determina ce factori contribuie predominant la apariÈ›ia uzurii utilizÃ¢nd tehnici de Ã®nvÄƒÈ›are precum clasificarea È™i regresia pentru a crea modele de predicÈ›ie din datele colectate. 
Am prelucrat setul de date, adÄƒugÃ¢nd o nouÄƒ coloanÄƒ denumitÄƒ EmployeeNr astfel Ã®ncÃ¢t fiecare angajat sÄƒ aibÄƒ un id unic.
:::

```{r}
##Pachete
#install.packages("tidyverse")
library(tidyverse)
#install.packages("dplyr")
library(dplyr)
#install.packages("caTools")
library(caTools)
#install.packages("class")
library(class)
#install.packages("rpart")
library(rpart)
#install.packages("rpart.plot")
library(rpart.plot)
#install.packages("e1071")
library(e1071)
library(class)
```


```{r}
## Incarcarea datelor
dateSDA<-read.csv("date_proiect_sda.csv", header=TRUE, sep=",")
View(dateSDA)

```


```{r}
## Prelucrarea setului de date
mat <- matrix (c(1:1470),nrow=1470, ncol=1, byrow=FALSE)
#View(mat)
colnames(mat) <- c("EmployeeNr")
date <- data.frame (mat, dateSDA)
#View(date)
date_proiect <- as_tibble(date)
str(date_proiect)
```


### 4.1.Regresia logisticÄƒ binomialÄƒ

::: justify
Pentru aplicarea regresiei logistice de tip binomial, am utilizat, ca variabila dependenta, coloana Attrition, iar ca variabile independente, MonthlyIncome (venitul solicitantului) si TotalWorkingYears (numar ani vechime).
::: 

```{r}
table(date_proiect$Attrition)
```
::: justify
Ãn cadrul setului de date, 1233 de persoane nu sunt epuizate, iar 237 de persoane resimt oboseala din cauza volumului mare de muncÄƒ.
::: 

```{r}
# Crearea variabilei factor 
date_proiect$Attrition.f<-factor(date_proiect$Attrition)
View(date_proiect)

# Crearea setului de antrenare si testare
set.seed(88)
View(date_proiect)
split=sample.split(date_proiect$Attrition.f, SplitRatio=0.75)
setantrenare<-subset(date_proiect, split==TRUE)
settestare<-subset(date_proiect, split==FALSE)

```

```{r}
plot<-ggplot(data=date_proiect, aes(x=date_proiect$MonthlyIncome, y=date_proiect$TotalWorkingYears, 
col=Attrition.f))
plot<-plot+geom_point(aes(size=5))
plot

```

::: justify
Ãn figura de mai sus, se poate observa È™i vizual distribuÈ›ia persoanelor epuizate È™i Ã®n formÄƒ, Ã®n funcÈ›ie de venit È™i vechimea Ã®n muncÄƒ.
::: 

```{r}
## Model de regresie binomiala
model<-glm(Attrition.f~MonthlyIncome+TotalWorkingYears, data=setantrenare, family=binomial)
summary(model)
exp(coef(model))
contrasts(date_proiect$Attrition.f)
```

::: justify
Prin intermediul acestui output pot fi evidenÈ›iate urmÄƒtoarele idei:

**1**.Forma ecuaÈ›iei de regresie:

**Ln(p/1âˆ’p) = -0.82972823 -- 0.00006704 \* MonthlyIncome - 0.04453172 \* TotalWorkingYears**

Unde: p = probabilitatea ca o persoanÄƒ sÄƒ nu fie epuizata (Attrition = No), conform venitului È™i a vechimii;

1-p = probabilitatea ca o persoanÄƒ sÄƒ fie epuizatÄƒ (Attrition = Yes), conform venitului È™i a vechimii.

AceastÄƒ ecuaÈ›ie indicÄƒ faptul cÄƒ ambele variabile afecteazÄƒ Ã®n mod negativ raportul Ln(p/1âˆ’p). Astfel, o creÈ™tere cu o unitate a venitului genereazÄƒ scÄƒderea raportului È™anselor ca o persoana sa fie epuizata cu 0.00006704 unitÄƒÈ›i. Asemanator, o crestere cu o unitate a vechimii produce o scÄƒdere a È™anselor ca persoana sÄƒ fie epuizatÄƒ cu 0.04453172 unitÄƒÈ›i. Din punctul nostru de vedere, rezultatele obÈ›inute nu corespund aÈ™teptÄƒrilor noastre.

**2**.DevianÈ›a rezidualÄƒ Ã®n valoare de 937.82 este mai micÄƒ decÃ¢t devianÈ›a nulÄƒ egalÄƒ cu 974.94, ceea ce Ã®nseamnÄƒ cÄƒ modelul este unul relativ bun.

**3**.Ãn ceea ce priveÈ™te coeficienÈ›ii funcÈ›iei exponenÈ›iale, putem afirma faptul cÄƒ: -- Probabilitatea (È˜ansele) ca o persoanÄƒ sÄƒ nu fie epuizatÄƒ creÈ™te de 0.9999330 ori dacÄƒ venitul persoanei creÈ™te cu 1 unitate. Raportul È™anselor = p/1âˆ’p = 0.9999330\
-- Probabilitatea (È˜ansele) de a nu achita Ã®mprumutul creÈ™te de 0.9564453 ori dacÄƒ rata dobÃ¢nzii creÈ™te cu 1 unitate. Raportul È™anselor = ğ‘/ 1âˆ’p = 0.9564453
:::

```{r}
prob<-predict(model, settestare, type="response")
pred<-rep("Yes", dim(setantrenare)[1])
pred[prob>.5]="No"
# Matricea de confuzie pentru setul de antrenare
table(pred, setantrenare$Attrition.f)

pred1<-rep("Yes", dim(settestare)[1])
pred1[prob>.5]="No"
# Matricea de confuzie pentru setul de testare
table(pred1, settestare$Attrition.f)
```

### 4.2. KNN pentru clasificare

::: justify
Pentru aceastÄƒ problemÄƒ vom È›ine cont de ultimele coloane din setul nostru de date È™i anume"MonthlyIncome","NumCompaniesWorked","TotalWorkingYears","TrainingTimesLast Year","YearsAtCompany",YearsInCurrentRole","YearsSinceLastPromotion","YearsWithCurrM anager", È™i de asemenea vom considera coloana "Attrition" drept etichetÄƒ.
::: 

```{r}
date1 <- date_proiect[,-c(1,2,3,4,5,6)]
View(date1)
date1<-data.frame(date1,date$Attrition)
View(date1)
```

::: justify
Extragem douÄƒ eÈ™antioane, corespunzÄƒtoare setului de antrenare Ã®n proporÈ›ie de 80% din date È™i setului de testare Ã®n proporÈ›ie de 20%. Dimensiunea setului de antrenare este de 1186 observaÈ›ii, iar a setului de testare de 284.
::: 

```{r}
set.seed(123)
ind<-sample(2, nrow(date1), replace=TRUE, prob=c(0.80,0.20))
antrenare<-date1[ind==1,1:8]
dim(antrenare)[1]
testare<-date1[ind==2,1:8]
dim(testare)[1]
etichetaantrenare<- date1[ind==1,9]
head(etichetaantrenare, 10)
length(etichetaantrenare)
etichetatestare<- date1[ind==2,9]
head(etichetatestare, 10)
length(etichetatestare)
```
::: justify
FixÄƒm cei mai apropiaÈ›i patru vecini ai oricÄƒrui obiect (k=4) È™i realizÄƒm predicÈ›ia. Matricea de confuzie ne comunicÄƒ faptul cÄƒ pe diagonala principalÄƒ se aflÄƒ numÄƒrul de observaÈ›ii corect previzionate, iar Ã®n rest sunt erori. Mai exact 226 de angajaÈ›i au fost corect catalogaÈ›i ca fiind Ã®ncÄƒ Ã®n putere, iar 9 angajaÈ›i au fost corect catalogaÈ›i ca fiind epuizaÈ›i. 17,25% din observaÈ›iile setului de testare sunt incorect clasificate.
::: 

```{r}
predictie<-knn(train=antrenare, test=testare, cl=etichetaantrenare, k=4)
head(predictie, 10)
tab<-table(valori_reale=etichetatestare, valori_previzionate=predictie)
head(tab, 10)
mean(etichetatestare!=predictie)
```
::: justify
Rata de acurateÈ›e a setului de testare este de 17,25%.
::: 


## 5. Concluzii
::: justify
Ãn urma aplicÄƒrii regresiei logistice binomiale, modelul creat are toÈ›i cei trei coefiecienÈ›i semnificativi, asta Ã®nsemnÃ¢nd cÄƒ o creÈ™tere cu o unitate a venitului genereazÄƒ scÄƒderea raportului È™anselor ca o persoana sa fie epuizata cu 0.00006704 unitÄƒÈ›i. Asemanator, o crestere cu o unitate a vechimii produce o scÄƒdere a È™anselor ca persoana sÄƒ fie epuizatÄƒ cu 0.04453172 unitÄƒÈ›i. De asemenea, previziunea realizatÄƒ pe baza modelului ne indicÄƒ, prin intermediul matricii de confuzie, faptul cÄƒ, pe setul de antrenare, au fost previzionate corect 178 de persoane ca fiind epuizate, iar pe setul de testare, 59 de persoane. Deci, modelul nu este unul foarte relevant.
Pe de altÄƒ parte, cu ajutorul analizei KNN pentru problema de clasificare, setÃ¢nd, Ã®n prealabil, 4 cei mai apropiaÈ›i vecini, am obÈ›inut o previzionare corecta pentru 235 de persoane dintre care 226 nu sunt epuizate È™i 9 sunt epuizate, conform matricii de confuzie. Din cauza faptului cÄƒ rata de acurateÈ›e a setului de testare este micÄƒ, nu ne putem Ã®ncrede pe deplin Ã®n analizÄƒ.
Pe viitor, pentru previziuni mai bune se pot incerca arbori de decizie, regresia logistica multinomiala si o analiza SVM de clasificare.
::: 